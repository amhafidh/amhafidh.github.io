<script>
  let canvas, ctx, ball, score, gameOver, startTime, playerName;

  function startGame() {
    playerName = document.getElementById('playerName').value.trim();
    if (!playerName) {
      alert("Please enter your name.");
      return;
    }

    // Hide start screen and show game elements
    document.getElementById('startScreen').style.display = 'none';
    document.getElementById('gameCanvas').style.display = 'block';
    document.getElementById('score').style.display = 'block';
    document.getElementById('message').style.display = 'block';

    // Initialize game
    canvas = document.getElementById('gameCanvas');
    ctx = canvas.getContext('2d');
    ball = { x: 245, y: 100, radius: 10, dx: 2, dy: 0 };
    score = 0;
    gameOver = false;
    startTime = Date.now();

    updateGame();
  }

  function drawBall() {
    ctx.beginPath();
    ctx.arc(ball.x, ball.y, ball.radius, 0, Math.PI * 2);
    ctx.fillStyle = 'red';
    ctx.fill();
    ctx.closePath();
  }

  function drawScore() {
    document.getElementById('score').innerText = `Score: ${score}`;
  }

  function updateGame() {
    if (gameOver) return;
    ctx.clearRect(0, 0, canvas.width, canvas.height);
    drawBall();
    drawScore();
    ball.x += ball.dx;
    ball.y += ball.dy;

    if (
      ball.x - ball.radius <= 0 ||
      ball.x + ball.radius >= canvas.width ||
      ball.y - ball.radius <= 0 ||
      ball.y + ball.radius >= canvas.height
    ) {
      gameOver = true;
      document.getElementById('message').innerText = `GAME OVER, ${playerName}! Final Score: ${score}`;
      return;
    }

    if (Date.now() - startTime > 10000) {
      gameOver = true;
      document.getElementById('message').innerText = `YOU WIN, ${playerName}! Final Score: ${score}`;
      return;
    }

    score++;
    requestAnimationFrame(updateGame);
  }

  document.addEventListener('keydown', (e) => {
    if (!gameOver) {
      switch (e.key) {
        case 'ArrowLeft': ball.dx = -2; ball.dy = 0; break;
        case 'ArrowRight': ball.dx = 2; ball.dy = 0; break;
        case 'ArrowUp': ball.dy = -2; ball.dx = 0; break;
        case 'ArrowDown': ball.dy = 2; ball.dx = 0; break;
      }
    }
  });
</script>
